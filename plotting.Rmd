---
title: "Plotting in R"
author: "Maria Pachiadaki"
date: "11/16/2021"
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: false
    highlight: tango
    
knit: (function(input_file, encoding) {
  out_dir <- '.';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, 'index.html'))})

---
```{r setup, include=FALSE}
library(knitr)
library(formatR)
library(rmdformats)
## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
# opts_knit$set(width=75, fig.width=12, fig.height=8)
```

# Explore different types of plots in ggplot2
ggplot2 BLURB

## Required packages
Install the following packages:
- palmerpenguin
- tidyvers
- ggpubr


## Dataset

We will use the [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/) dataset. Data were collected and made available by Dr. Kristen Gorman and the Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.

We will briefly check the datastructure before we start plotting.

```{r check penguins, echo=TRUE}
library(palmerpenguins) # load palmerpenguins dataset
head(penguins) #check table structure
```

```{r summarize penguins, echo =TRUE}
summary(penguins)  #summarize data
```

As we can see from the summary table three different species of penguins were recorded in three different islands.

## Scatterplot
Let's explore if there is a correlation between the body mass of the penguins and the flipper length

```{r plot body mass vs flipper length, echo =TRUE}
library(tidyverse) # load the tidyverse package; contains ggplot2

ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g))+geom_point()
```

Let's add a trendline
```{r plot body mass vs flipper length and trendline, echo =TRUE}


ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g))+geom_point()+ geom_smooth(method="lm") 
```

Let's add a trendline together with the equation 
```{r plot body mass vs flipper length and trendline and equation, echo =TRUE}

library(ggpubr) #package the facilitates the display of the equation

ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g))+geom_point()+ geom_smooth(method="lm") + stat_regline_equation(label.y = 6000, aes(label = ..eq.label..)) + stat_regline_equation(label.y = 5600, aes(label = ..rr.label..))
```

Are there any differences between the species?
```{r plot body mass vs flipper length and trendline in the different species, echo =TRUE}
#regression equations will overlap, we will use faceting for them
ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g, color=species))+geom_point()+ geom_smooth(method="lm")

```

```{r use different shapes for the sexes, echo =TRUE}


ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g, color=species))+geom_point(aes(shape=sex))

```

## Themes
There are [built in ggplot themes](https://ggplot2.tidyverse.org/reference/ggtheme.html) or there is a long list of cosmetic changes you can make with [theme()](https://ggplot2.tidyverse.org/reference/theme.html).
Let's try changing themes in other type of plot, histograms. Let's plot the distribution of the flipper length for each species. We will use my favourite theme: them_bw()

https://r-charts.com/ggplot2/themes/

```{r histogram bw_theme, echo =TRUE}

ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+theme_bw()

```


```{r histogram void theme, echo =TRUE}

ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+
  theme_void()

```

Themes can be modified

### Labels
```{r histogram bw_theme modify labels, echo =TRUE}

ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+
  theme_bw() +
  labs(x = "Flipper length (mm)", y = "Counts")+
  theme(axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14))
  

```

### Axis

```{r histogram modify axis , echo =TRUE}
#modify axis font size
ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+theme_bw()+
  labs(x = "Flipper length (mm)", y = "Counts")+
  theme(axis.text.x = element_text(color = "black", size = 12),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14))
 

```
You can also change the color, angle, and justification of the axis labels.

```{r histogram further modify axis, echo =TRUE}
#modify axis font size
ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+theme_bw()+
  labs(x = "Flipper length (mm)", y = "Counts")+
  theme(axis.text.x = element_text(color = "black", size = 12, angle = 45),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "grey30", face = "bold", size = 14),
        axis.title.y = element_text(color = "grey30", face = "bold", size = 14))
 

```

The horizontal or vertical justification, (*hjust* and *vjust*) can also be adjusted. This hjust and vjust argument can be best explained using this figure [[Source from Stackoverflow](https://stackoverflow.com/questions/7263849/what-do-hjust-and-vjust-do-when-making-a-plot-using-ggplot)]:

```{r out.width ="50%", echo=FALSE}
knitr::include_graphics("figures-images/hjust-vjust.png")
```

e.g.:
```{r histogram further modify axis adjust, echo =TRUE}
ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+theme_bw()+
  labs(x = "Flipper length (mm)", y = "Counts")+
  theme(axis.text.x = element_text(color = "black", size = 12, angle = 45, hjust = 1, vjust = 1),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "grey30", face = "bold", size = 14),
        axis.title.y = element_text(color = "grey30", face = "bold", size = 14))
 

```


### Legends

```{r histogram modify legends , echo =TRUE}

ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+
  theme_bw()+
  labs(x = "Flipper length (mm)", y = "Counts", fill="Species")+
  theme(axis.text.x = element_text(color = "black", size = 12),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14),
        legend.title=element_text(color = "black", face = "bold", size=14), 
        legend.text=element_text(size=12))

 

```


###Colors

## Barplot


## Boxplots
```{r plot flipper length distribution distributio in the different species and sexes, echo =TRUE}


ggplot(penguins, aes(x=species, y=flipper_length_mm, fill=sex))+
  geom_boxplot()+ 
  theme_bw()+
  labs(x = "Species", y = "Flipper length (mm)")+
  theme(axis.text.x = element_text(color = "black", size = 12),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14))
 

```

```{r plot flipper length distribution distributio in the different species and sexes omitNA, echo =TRUE}


ggplot(na.omit(penguins), aes(x=species, y=flipper_length_mm, fill=sex))+
  geom_boxplot()+ 
  theme_bw()+
  labs(x = "Species", y = "Flipper length (mm)")+
  theme(axis.text.x = element_text(color = "black", size = 12),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14))
```

```{r plot body flipper length distribution in the different species add ind observations, echo =TRUE}


ggplot(na.omit(penguins), aes(x=species, y=flipper_length_mm, fill=sex))+
  geom_boxplot()+
  geom_jitter(color="black", size=0.4, alpha=0.9) + 
  theme_bw()+
  labs(x = "Species", y = "Flipper length (mm)")+
  theme(axis.text.x = element_text(color = "black", size = 12),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14))

```

## Violinplots

```{r plot flipper length distribution in the different species using violin, echo =TRUE}


ggplot(na.omit(penguins), aes(x=species, y=flipper_length_mm, fill=sex))+
  geom_violin()+ 
  theme_bw()+
  labs(x = "Species", y = "Flipper length (mm)")+
  theme(axis.text.x = element_text(color = "black", size = 12),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14))

```


```{r as above overlaying boxplot, echo =TRUE}


ggplot(na.omit(penguins), aes(x=species, y=flipper_length_mm, fill=sex))+
  geom_violin()+
  geom_boxplot(position=position_dodge(width=0.9), width=0.2) +
  theme_bw()+
  labs(x = "Species", y = "Flipper length (mm)")+
  theme(axis.text.x = element_text(color = "black", size = 12),
        axis.text.y = element_text(color = "black", size = 12),
        axis.title.x = element_text(color = "black", face = "bold", size = 14),
        axis.title.y = element_text(color = "black", face = "bold", size = 14))
```




## Faceting


## Colors


# Plot interactively with plotly or dygraphs

```{r plotly, echo =TRUE}

library(plotly)

```
