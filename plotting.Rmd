---
title: "Plotting in R"
author: "Maria Pachiadaki"
date: "11/16/2021"
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: false
    highlight: tango
    
knit: (function(input_file, encoding) {
  out_dir <- '.';
  rmarkdown::render(input_file,
 encoding=encoding,
 output_file=file.path(dirname(input_file), out_dir, 'index.html'))})

---
```{r setup, include=FALSE}
library(knitr)
library(formatR)
library(rmdformats)
## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
	             cache=TRUE,
               prompt=FALSE,
               tidy=TRUE,
               comment=NA,
               message=FALSE,
               warning=FALSE)
# opts_knit$set(width=75, fig.width=12, fig.height=8)
```

# Explore different types of plots in ggplot2
ggplot2 BLURB

## Required packages

## Dataset

We will use the [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/) dataset. Data were collected and made available by Dr. Kristen Gorman and the Palmer Station, Antarctica LTER, a member of the Long Term Ecological Research Network.

We will briefly check the datastructure before we start plotting.

```{r check penguins, echo=TRUE}
head(penguins) #check table structure
```

```{r summarize penguins, echo =TRUE}
library(palmerpenguins) # load the penguins dataset
summary(penguins) #summatize data
```

As we can see from the summary table three different species of penguins were recorded in three different islands.

## Scatterplot
Let's explore if there is a correlation between the body mass of the penguins and the flipper length

```{r plot body mass vs flipper length, echo =TRUE}
library(tidyverse) # load the tiverse package

ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g))+geom_point()
```

Let's add a tredline
```{r plot body mass vs flipper length and trendline, echo =TRUE}


ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g))+geom_point()+ geom_smooth(method="lm") 
```

Let's add a tredline together with the equation 
```{r plot body mass vs flipper length and trendline and equation, echo =TRUE}

library(ggpubr)

ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g))+geom_point()+ geom_smooth(method="lm") + stat_regline_equation(label.y = 6000, aes(label = ..eq.label..)) + stat_regline_equation(label.y = 5600, aes(label = ..rr.label..))
```

Are there any differences between the species?
```{r plot body mass vs flipper length and trendline in the different species, echo =TRUE}


ggplot(penguins, aes(x=flipper_length_mm, y=body_mass_g, color=species))+geom_point()+ geom_smooth(method="lm")

#regression equations will overlap, we will use faceting for them
```

## Themes
Let's try changing themes in other type of plot, histograms. Let's plot the distribution of the flipper length for each species. We will use my favourite theme: them_bw()

https://r-charts.com/ggplot2/themes/

```{r histogram bw_theme, echo =TRUE}

ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+theme_bw()

```


```{r histogram , echo =TRUE}

ggplot(penguins, aes(flipper_length_mm, fill=species)) + 
  geom_histogram(alpha=0.6, position="identity")+theme_classic2()

```

Themes can be modified

### Labels

### Axis

### Legends


## Barplot


## Boxplots
```{r plot flipper length distribution distributio in the different species and sexes, echo =TRUE}


ggplot(penguins, aes(x=species, y=flipper_length_mm, fill=sex))+geom_boxplot()+ theme_bw()

#regression equations will overlap, we will use faceting for them
```

```{r plot flipper length distribution distributio in the different species and sexes omitNA, echo =TRUE}


ggplot(na.omit(penguins), aes(x=species, y=flipper_length_mm, fill=sex))+geom_boxplot()+ theme_bw()

```

```{r plot body flipper length distribution in the different species add ind observations, echo =TRUE}


ggplot(na.omit(penguins), aes(x=species, y=flipper_length_mm, fill=sex))+geom_boxplot()+geom_jitter(color="black", size=0.4, alpha=0.9) + theme_bw()

```

## Violinplots

```{r plot flipper length distribution in the different species using violin, echo =TRUE}


ggplot(na.omit(penguins), aes(x=species, y=flipper_length_mm, fill=sex))+geom_violin()+ theme_bw()

```

## Faceting



